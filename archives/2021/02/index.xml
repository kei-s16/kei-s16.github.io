<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>2021/02 on blog</title><link>/archives/2021/02/</link><description>Recent content in 2021/02 on blog</description><generator>Hugo -- gohugo.io</generator><atom:link href="/archives/2021/02/index.xml" rel="self" type="application/rss+xml"/><item><title>k8s Cluster on Raspberry Pi</title><link>/posts/k8s-cluster-on-raspberry-pi/</link><pubDate>Wed, 10 Feb 2021 20:00:00 +0900</pubDate><guid>/posts/k8s-cluster-on-raspberry-pi/</guid><description>kei-s16/k8s-arch-rpi-cluster.md ã‚’å…ƒã«åŠ ç­†ãƒ»ä¿®æ­£ã‚’è¡Œã£ãŸã‚‚ã®ã§ã™ åŸºæœ¬çš„ã«2021å¹´é ­ã®æƒ…å ±ã«ãªã£ã¦ãŠã‚Šã€ã™ã§ã«æ™‚ä»£é…ã‚Œã§ã‚ã£ãŸã‚Šã€é–“é•ã„ã«æ°—ã¥ã„ã¦å®Ÿéš›ã®é‹ç”¨ã§ã¯æ”¹å–„æ¸ˆã®ã‚‚ã®ãŒè¨˜äº‹ã«ã¯å«ã¾ã‚Œã¦ã„ã¾ã™ ãªã«ã‚„ã£ãŸã®ã‹ï¼Ÿ rpi4 * 3 ã§ k8s ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹ æ§‹æˆ rpi 4 (4GB) Arch Linux (ARM) ä½œæ¥­ç’°å¢ƒ Raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚ Windowsã®ä¸–ç•Œ ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨ Arch on WSL2 kei@Win-Desktop-wsl OS: Arch Linux on Windows 10 x86_64 Kernel: 5.4.72-microsoft-standard-WSL2 Shell: zsh 5.8 CPU: AMD Ryzen 7 3800X (16) @ 3.892GHz Memory: 279MiB / 12733MiB ArchLinux for ARM64ãŒã‚“ã°ã‚‹ã¨ã“ã‚ Raspbian(32bit) Kubernet</description><content>&lt;p>&lt;a href="https://gist.github.com/kei-s16/91cc87b127f38cfed28fe625ae8c9ba9">kei-s16/k8s-arch-rpi-cluster.md&lt;/a> ã‚’å…ƒã«åŠ ç­†ãƒ»ä¿®æ­£ã‚’è¡Œã£ãŸã‚‚ã®ã§ã™&lt;br>
åŸºæœ¬çš„ã«2021å¹´é ­ã®æƒ…å ±ã«ãªã£ã¦ãŠã‚Šã€ã™ã§ã«æ™‚ä»£é…ã‚Œã§ã‚ã£ãŸã‚Šã€é–“é•ã„ã«æ°—ã¥ã„ã¦å®Ÿéš›ã®é‹ç”¨ã§ã¯æ”¹å–„æ¸ˆã®ã‚‚ã®ãŒè¨˜äº‹ã«ã¯å«ã¾ã‚Œã¦ã„ã¾ã™&lt;/p>
&lt;hr>
&lt;h2 id="ãªã«ã‚„ã£ãŸã®ã‹">ãªã«ã‚„ã£ãŸã®ã‹ï¼Ÿ&lt;/h2>
&lt;p>rpi4 * 3 ã§ k8s ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹&lt;/p>
&lt;h2 id="æ§‹æˆ">æ§‹æˆ&lt;/h2>
&lt;ul>
&lt;li>rpi 4 (4GB)
&lt;ul>
&lt;li>Arch Linux (ARM)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="ä½œæ¥­ç’°å¢ƒ">ä½œæ¥­ç’°å¢ƒ&lt;/h2>
&lt;h3 id="raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚">Raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚&lt;/h3>
&lt;p>Windowsã®ä¸–ç•Œ&lt;/p>
&lt;h3 id="ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨">ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨&lt;/h3>
&lt;p>Arch on WSL2&lt;/p>
&lt;pre tabindex="0">&lt;code>kei@Win-Desktop-wsl
OS: Arch Linux on Windows 10 x86_64
Kernel: 5.4.72-microsoft-standard-WSL2
Shell: zsh 5.8
CPU: AMD Ryzen 7 3800X (16) @ 3.892GHz
Memory: 279MiB / 12733MiB
&lt;/code>&lt;/pre>&lt;h3 id="archlinux-for-arm64ãŒã‚“ã°ã‚‹ã¨ã“ã‚">ArchLinux for ARM64ãŒã‚“ã°ã‚‹ã¨ã“ã‚&lt;/h3>
&lt;p>Raspbian(32bit)&lt;/p>
&lt;h3 id="kubernetesãŒã‚“ã°ã‚‹ã¨ã“ã‚">KubernetesãŒã‚“ã°ã‚‹ã¨ã“ã‚&lt;/h3>
&lt;p>ArchLinux ARM(64bit) on Raspberry Pi&lt;/p>
&lt;h2 id="ä½œæ¥­æ‰‹é †">ä½œæ¥­æ‰‹é †&lt;/h2>
&lt;h3 id="ä¸‹æº–å‚™ãƒ•ã‚§ã‚¤ã‚º">ä¸‹æº–å‚™ãƒ•ã‚§ã‚¤ã‚º&lt;/h3>
&lt;ol>
&lt;li>çµ„ã¿ç«‹ã¦ã‚„ã£ã¦ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸Šã’ã‚‹&lt;/li>
&lt;li>ãƒ¡ã‚¤ãƒ³ã®LANã«ã¶ã‚‰ã•ã’ã‚‹LANã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—&lt;/li>
&lt;li>Raspbian ã‚’ headlessã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
&lt;ol>
&lt;li>ãƒ«ãƒ¼ã‚¿ã«æœ‰ç·šã§æ¥ç¶šã—ã¦ssh
&lt;ol>
&lt;li>æ–°ãƒ¦ãƒ¼ã‚¶ä½œã£ã¦piãƒ¦ãƒ¼ã‚¶æ¶ˆã™&lt;/li>
&lt;li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰â†’éµèªè¨¼ã¯ã‚„ã‚‰ãªã„(raspbianã‚’ã“ã®ã‚ã¨ä½¿ã‚ãªã„ã®ã§)&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Raspbian ä¸Š ã§ ArchLinux ARM ã‚’ç„¼ã&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># $ã¯ã™ã¹ã¦ sudo&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ fdisk /dev/sda
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ã„ã„ã‹ã‚“ã˜ã«ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ‡ã‚‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mkfs.vfat /dev/sda1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mkdir boot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mount /dev/sda1 boot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mkfs.ext4 /dev/sda2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mkdir root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ mount /dev/sda2 root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ã‚¤ãƒ¡ãƒ¼ã‚¸è½ã¨ã™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ wget http://os.archlinuxarm.org/os/ArchLinuxARM-rpi-aarch64-latest.tar.gz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ã“ã“ã‹ã‚‰å…ˆã¯suã™ã‚‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ su
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% bsdtar -xpf ArchLinuxARM-rpi-4-latest.tar.gz -C root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% sync
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 64bit ã‹ã¤ rpi4 ãªã®ã§&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% sed -i &lt;span style="color:#e6db74">&amp;#39;s/mmcblk0/mmcblk1/g&amp;#39;&lt;/span> root/etc/fstab
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% mv root/boot/* boot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ãƒã‚¦ãƒ³ãƒˆã—ãŸã‚‰ã¡ã‚ƒã‚“ã¨ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã—ã‚ˆã†ã­&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>% umount boot root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ã“ã‚Œã‚’3ã‚»ãƒƒãƒˆ (ã•ã‚‰ã«åˆ¥ç”¨é€”ã§+1ã‚»ãƒƒãƒˆã‚„ã£ãŸã®ã¯ç§˜å¯†)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æœ¬ä½œæ¥­ãƒ•ã‚§ã‚¤ã‚º">æœ¬ä½œæ¥­ãƒ•ã‚§ã‚¤ã‚º&lt;/h3>
&lt;h4 id="å„ãƒã‚·ãƒ³ã«ãƒ›ã‚¹ãƒˆåãµã£ãŸã‚Šãƒ¦ãƒ¼ã‚¶ä½œã£ãŸã‚Š">å„ãƒã‚·ãƒ³ã«ãƒ›ã‚¹ãƒˆåãµã£ãŸã‚Šãƒ¦ãƒ¼ã‚¶ä½œã£ãŸã‚Š&lt;/h4>
&lt;ul>
&lt;li>&lt;code>pacman -Syyu&lt;/code> ã‚ã£ã¡ã‚ƒé‡ã„(å›½å†…ãƒŸãƒ©ãƒ¼ãªã•ãã†)&lt;/li>
&lt;li>&lt;code>pacman -S sudo&lt;/code>&lt;/li>
&lt;li>ãƒ›ã‚¹ãƒˆåå¤‰ãˆãŸ
&lt;ul>
&lt;li>kisaragi&lt;/li>
&lt;li>mogami&lt;/li>
&lt;li>kumano&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>sudoersã„ã˜ã£ãŸ&lt;/li>
&lt;li>å…¬é–‹éµèªè¨¼ä»¥å¤–å°ã˜ãŸ&lt;/li>
&lt;/ul>
&lt;h4 id="kubernetesã¾ã‚ã‚Šã‚¬ãƒ¼ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">Kubernetesã¾ã‚ã‚Šã‚¬ãƒ¼ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h4>
&lt;ul>
&lt;li>Ansibleã§ã‚„ã‚ã†ã¨ã—ãŸãŒã€pacmanã ã‘ã§ãªãyayã‚‚ä½¿ã†ã®ã§ã¡ã‚‡ã£ã¨å³ã—ã‹ã£ãŸ
&lt;ul>
&lt;li>ã®ã§æ¨ªç€ã—ã¦ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ›¸ã„ãŸãŒæ¨ªç€ã—ã™ãã¦ã‚³ã‚±ãŸ
&lt;ul>
&lt;li>ã®ã§æœ€çµ‚çš„ã«åŠæ‰‹ä½œæ¥­â€¦â€¦&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash -eu
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>pacman -S git base base-devel --noconfirm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir ~/build/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ~/build
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git clone https://aur.archlinux.org/yay.git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ~/build/yay
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>makepkg -si --noconfirm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ~/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yay -S docker kubelet-bin kubeadm-bin kubectl-bin ebtables ethtool socat conntrack-tools cni-plugins --noconfirm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="kubernetesã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—">Kubernetesã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—&lt;/h4>
&lt;h5 id="å…¨ä½“æ§‹æˆ">å…¨ä½“æ§‹æˆ&lt;/h5>
&lt;ul>
&lt;li>kisaragi : Master&lt;/li>
&lt;li>mogami : node&lt;/li>
&lt;li>kumano : node&lt;/li>
&lt;/ul>
&lt;p>ãŠèˆ¹ã˜ã‚ƒãªã„ã‚ˆ&lt;/p>
&lt;h5 id="kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‰åŠæˆ¦">kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‰åŠæˆ¦&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>sudo kubeadm init --pod-network-cidr&lt;span style="color:#f92672">=&lt;/span>10.244.0.0/16
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p $HOME/.kube
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo chown &lt;span style="color:#66d9ef">$(&lt;/span>id -u&lt;span style="color:#66d9ef">)&lt;/span>:&lt;span style="color:#66d9ef">$(&lt;/span>id -g&lt;span style="color:#66d9ef">)&lt;/span> $HOME/.kube/config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="mogami--kumanoã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—">mogami &amp;amp; kumanoã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>sudo systemctl enable kubelet.service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl start kubelete.service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo kubeadm join &lt;span style="color:#f92672">{&lt;/span>ã„ã‚ã‚“ãªã²ã¿ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h5 id="kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾ŒåŠæˆ¦">kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾ŒåŠæˆ¦&lt;/h5>
&lt;p>ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«ãƒãƒ¼ãƒ‰ã‚’å‚åŠ ã•ã›ã‚‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>kubectl label node mogami node-role.kubernetes.io/worker&lt;span style="color:#f92672">=&lt;/span>worker
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kubectl label node kumano node-role.kubernetes.io/worker&lt;span style="color:#f92672">=&lt;/span>worker
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>kisaragi% kubectl version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Client Version: version.Info&lt;span style="color:#f92672">{&lt;/span>Major:&lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>, Minor:&lt;span style="color:#e6db74">&amp;#34;20&amp;#34;&lt;/span>, GitVersion:&lt;span style="color:#e6db74">&amp;#34;v1.20.2&amp;#34;&lt;/span>, GitCommit:&lt;span style="color:#e6db74">&amp;#34;faecb196815e248d3ecfb03c680a4507229c2a56&amp;#34;&lt;/span>, GitTreeState:&lt;span style="color:#e6db74">&amp;#34;clean&amp;#34;&lt;/span>, BuildDate:&lt;span style="color:#e6db74">&amp;#34;2021-01-13T13:28:09Z&amp;#34;&lt;/span>, GoVersion:&lt;span style="color:#e6db74">&amp;#34;go1.15.5&amp;#34;&lt;/span>, Compiler:&lt;span style="color:#e6db74">&amp;#34;gc&amp;#34;&lt;/span>, Platform:&lt;span style="color:#e6db74">&amp;#34;linux/arm64&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Server Version: version.Info&lt;span style="color:#f92672">{&lt;/span>Major:&lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>, Minor:&lt;span style="color:#e6db74">&amp;#34;20&amp;#34;&lt;/span>, GitVersion:&lt;span style="color:#e6db74">&amp;#34;v1.20.2&amp;#34;&lt;/span>, GitCommit:&lt;span style="color:#e6db74">&amp;#34;faecb196815e248d3ecfb03c680a4507229c2a56&amp;#34;&lt;/span>, GitTreeState:&lt;span style="color:#e6db74">&amp;#34;clean&amp;#34;&lt;/span>, BuildDate:&lt;span style="color:#e6db74">&amp;#34;2021-01-13T13:20:00Z&amp;#34;&lt;/span>, GoVersion:&lt;span style="color:#e6db74">&amp;#34;go1.15.5&amp;#34;&lt;/span>, Compiler:&lt;span style="color:#e6db74">&amp;#34;gc&amp;#34;&lt;/span>, Platform:&lt;span style="color:#e6db74">&amp;#34;linux/arm64&amp;#34;&lt;/span>&lt;span style="color:#f92672">}}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ãªã‚“ã‹podå‹•ã‹ã—ã¦ã¿ã‚‹">ãªã‚“ã‹podå‹•ã‹ã—ã¦ã¿ã‚‹&lt;/h4>
&lt;p>ã‚ªãƒ¬ã‚ªãƒ¬Docker Registryç½®ãã“ã¨ã«ã—ãŸ&lt;/p>
&lt;p>deployment.yml&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">apiVersion&lt;/span>: &lt;span style="color:#ae81ff">apps/v1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">kind&lt;/span>: &lt;span style="color:#ae81ff">Deployment&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">metadata&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">docker-registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">labels&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">app&lt;/span>: &lt;span style="color:#ae81ff">docker-registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">spec&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">replicas&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">selector&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">matchLabels&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">app&lt;/span>: &lt;span style="color:#ae81ff">docker-registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">template&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">metadata&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">labels&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">app&lt;/span>: &lt;span style="color:#ae81ff">docker-registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">spec&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostNetwork&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tolerations&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">key&lt;/span>: &lt;span style="color:#ae81ff">node-role.kubernetes.io/master&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">effect&lt;/span>: &lt;span style="color:#ae81ff">NoSchedule&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">nodeSelector&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">kubernetes.io/hostname&lt;/span>: &lt;span style="color:#ae81ff">kisaragi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">containers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">docker-registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">registry:2.7.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">containerPort&lt;/span>: &lt;span style="color:#ae81ff">5000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumeMounts&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mountPath&lt;/span>: &lt;span style="color:#ae81ff">/var/lib/registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">registry&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostPath&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Directory&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/mnt/exthdd/registry&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ã“ã‚Œã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã€å¤–ã‹ã‚‰pull &amp;amp; pushã—ã¦ã¿ã‚‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>sudo docker pull hello-world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo docker tag hello-world kisaragi.local:5000/hello-world
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo docker push kisaragi.local:5000/hello-world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>å‹•ã„ãŸï¼&lt;/strong>&lt;/p>
&lt;h2 id="ãã®ä»–ã‚‚ã‚ã‚‚ã‚">ãã®ä»–ã‚‚ã‚ã‚‚ã‚&lt;/h2>
&lt;h3 id="ã¤ã‚‰ã‹ã£ãŸã“ã¨">ã¤ã‚‰ã‹ã£ãŸã“ã¨&lt;/h3>
&lt;ul>
&lt;li>ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§å†èµ·å‹•ã‹ã‘ãŸã‚‰ &lt;code>kubectl&lt;/code> ã‚³ã‚±ãŸ
&lt;ul>
&lt;li>masterã§ &lt;code>systemctl enable kubelet&lt;/code> å¿˜ã‚Œã¦ãŸ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¸€ç¬ä¸–ç•Œã‹ã‚‰å­¤ç«‹ã—ãŸã‚µãƒ¼ãƒã‚’ç”£ã¿è½ã¨ã—ã¦ã—ã¾ã£ãŸ
&lt;ul>
&lt;li>&lt;code>~/.ssh/authorized_keys&lt;/code> ã‚’æ¶ˆã—ã¦ã—ã¾ã£ãŸ&lt;/li>
&lt;li>åˆ¥ãƒã‚·ãƒ³ã§SDã‚«ãƒ¼ãƒ‰ã‚’ãƒã‚¦ãƒ³ãƒˆã—ã¦ &lt;code>authorized_keys&lt;/code> ã‚’ä½œã‚‹ã“ã¨ã§ã”ã¾ã‹ã—ãŸ
&lt;ul>
&lt;li>&lt;code>chmod {ãƒ¦ãƒ¼ã‚¶å}:sudo authorized_keys&lt;/code> å¿˜ã‚Œãšã«ã­&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨ä»Šå¾Œã‚„ã‚ŠãŸã„ã“ã¨">ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨(ä»Šå¾Œã‚„ã‚ŠãŸã„ã“ã¨)&lt;/h3>
&lt;ul>
&lt;li>PoE(USBã‚±ãƒ¼ãƒ–ãƒ«é‚ªé­”ã˜ã‚ƒã­ï¼Ÿ)&lt;/li>
&lt;li>ãƒãƒ¼ãƒ‰å°æ•°ã®æ‹¡å¼µ&lt;/li>
&lt;li>ç„¡ç·šLANãƒ«ãƒ¼ã‚¿ãŒã¡ã‚‡ã£ã¨æ®‹å¿µã ã£ãŸã®ã§æ”¹å–„
&lt;ul>
&lt;li>ãƒ©ã‚ºãƒ‘ã‚¤ãƒ«ãƒ¼ã‚¿ã«ã—ã¡ã‚ƒã†&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="çµè«–">çµè«–&lt;/h2>
&lt;ul>
&lt;li>ArchLinuxã¯ã„ã„ã&lt;/li>
&lt;li>k8sã¯ã„ã„ã&lt;/li>
&lt;li>æ¨ªç€ã¯ã‚ˆããªã„ã&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒè¨˜äº‹">å‚è€ƒè¨˜äº‹&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://archlinuxarm.org/platforms/armv8/broadcom/raspberry-pi-4">Raspberry Pi 4 | ArchLinux ARM&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/tomotomo/items/2ff445377c13f9db38e2">Raspberry Pi 4 ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ãŒå¤‰ã‚ã£ãŸã&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developers.cyberagent.co.jp/blog/archives/14721/">3æ—¥é–“ã‚¯ãƒƒã‚­ãƒ³ã‚°ã€Kubernetes ã®ãƒ©ã‚ºãƒšãƒªãƒ¼ãƒ‘ã‚¤åŒ…ã¿ã€€â€œã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¢¨ã€‘&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/go_vargo/items/d1271ab60f2bba375dcc">Raspberry Piã§ãŠã†ã¡Kubernetesæ§‹ç¯‰ã€ç‰©ç†ç·¨ã€‘&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/go_vargo/items/29f6d832ea0a289b4778">Raspberry Piã§ãŠã†ã¡Kubernetesæ§‹ç¯‰ã€è«–ç†ç·¨ã€‘&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/temeteke/items/04960c96edee113bd053">Raspberry Pi 4ã¨Arch Linux(64bit)ã§ä½œã‚‹Kubernetesã‚¯ãƒ©ã‚¹ã‚¿)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://sminamot-dev.hatenablog.com/entry/2020/01/26/111949">Raspberry Pi 4 ã§ãŠã†ã¡k8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ§‹ç¯‰ã™ã‚‹&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/yuyakato/items/c5b1b1293c5879e231ab">ãŠã†ã¡k8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹: Dockerãƒ¬ã‚¸ã‚¹ãƒˆãƒªç·¨&lt;/a>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="è£œè¶³">è£œè¶³&lt;/h2>
&lt;p>é‡è¦ãªã‚‚ã®ã ã‘è£œè¶³&lt;/p>
&lt;blockquote>
&lt;p>pacman -Syyu ã‚ã£ã¡ã‚ƒé‡ã„(å›½å†…ãƒŸãƒ©ãƒ¼ãªã•ãã†)&lt;/p>
&lt;/blockquote>
&lt;p>ã¨ã„ã†è¨˜è¿°ãŒã‚ã‚Šã¾ã—ãŸãŒã€2021/11/18ã«Asahi LinuxãŒå›½å†…ãƒŸãƒ©ãƒ¼ã‚’ä½œæˆã—ã¦ãã‚Œã¾ã—ãŸï¼&lt;/p>
&lt;blockquote class="twitter-tweet">&lt;p lang="en" dir="ltr">We noticed that there was no Arch Linux ARM mirror in Japan, so we&amp;#39;re sponsoring one now ğŸ˜Š&lt;br>&lt;br>If you&amp;#39;re in Japan or nearby, feel free to point your pacman.d/mirrorlist at &lt;a href="https://t.co/GM69rZE3tC">https://t.co/GM69rZE3tC&lt;/a>!&lt;a href="https://t.co/erKHtHwFfX">https://t.co/erKHtHwFfX&lt;/a> &lt;a href="https://t.co/m0opnupc5i">pic.twitter.com/m0opnupc5i&lt;/a>&lt;/p>&amp;mdash; Asahi Linux (@AsahiLinux) &lt;a href="https://twitter.com/AsahiLinux/status/1461268746878656513?ref_src=twsrc%5Etfw">November 18, 2021&lt;/a>&lt;/blockquote>
&lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8">&lt;/script></content></item></channel></rss>