<!doctype html><html lang=ja><head><title>k8s Cluster on Raspberry Pi :: blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="tl;dr archlinuxarmãƒ™ãƒ¼ã‚¹ãªk8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’Raspberry Pi * 4ã§ä½œã£ãŸæ™‚ã®è¨˜éŒ²"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/k8s-cluster-on-raspberry-pi/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/blue.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="_kei_s"><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="og:title" content="k8s Cluster on Raspberry Pi"><meta property="og:description" content="tl;dr archlinuxarmãƒ™ãƒ¼ã‚¹ãªk8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’Raspberry Pi * 4ã§ä½œã£ãŸæ™‚ã®è¨˜éŒ²"><meta property="og:url" content="/posts/k8s-cluster-on-raspberry-pi/"><meta property="og:site_name" content="blog"><meta property="og:image" content="/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="æŠ€è¡“"><meta property="article:published_time" content="2021-02-10 20:00:00 +0900 +0900"><script data-goatcounter=https://k16em.goatcounter.com/count async src=//gc.zgo.at/count.js></script></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>blog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/categories>ã‚«ãƒ†ã‚´ãƒª</a></li><li><a href=/tags>ã‚¿ã‚°</a></li><li><a href=/archives>æœˆåˆ¥ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/categories>ã‚«ãƒ†ã‚´ãƒª</a></li><li><a href=/tags>ã‚¿ã‚°</a></li><li><a href=/archives>æœˆåˆ¥ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/k8s-cluster-on-raspberry-pi/>k8s Cluster on Raspberry Pi</a></h1><div class=post-meta><span class=post-date>2021-02-10</span>
<span class=post-author>:: kei</span></div><span class=post-tags>#<a href=/tags/raspberrypi/>raspberrypi</a>&nbsp;
#<a href=/tags/k8s/>k8s</a>&nbsp;
#<a href=/tags/archlinuxarm/>archlinuxarm</a>&nbsp;</span><div class=post-content><div><p><a href=https://gist.github.com/kei-s16/91cc87b127f38cfed28fe625ae8c9ba9>kei-s16/k8s-arch-rpi-cluster.md</a> ã‚’å…ƒã«åŠ ç­†ãƒ»ä¿®æ­£ã‚’è¡Œã£ãŸã‚‚ã®ã§ã™<br>åŸºæœ¬çš„ã«2021å¹´é ­ã®æƒ…å ±ã«ãªã£ã¦ãŠã‚Šã€ã™ã§ã«æ™‚ä»£é…ã‚Œã§ã‚ã£ãŸã‚Šã€é–“é•ã„ã«æ°—ã¥ã„ã¦å®Ÿéš›ã®é‹ç”¨ã§ã¯æ”¹å–„æ¸ˆã®ã‚‚ã®ãŒè¨˜äº‹ã«ã¯å«ã¾ã‚Œã¦ã„ã¾ã™</p><hr><h2 id=ãªã«ã‚„ã£ãŸã®ã‹>ãªã«ã‚„ã£ãŸã®ã‹ï¼Ÿ<a href=#ãªã«ã‚„ã£ãŸã®ã‹ class=hanchor arialabel=Anchor>&#8983;</a></h2><p>rpi4 * 3 ã§ k8s ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹</p><h2 id=æ§‹æˆ>æ§‹æˆ<a href=#æ§‹æˆ class=hanchor arialabel=Anchor>&#8983;</a></h2><ul><li>rpi 4 (4GB)<ul><li>Arch Linux (ARM)</li></ul></li></ul><h2 id=ä½œæ¥­ç’°å¢ƒ>ä½œæ¥­ç’°å¢ƒ<a href=#ä½œæ¥­ç’°å¢ƒ class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚>Raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚<a href=#raspbianã‚¤ãƒ¡ãƒ¼ã‚¸ç„¼ãã¨ã“ã‚ class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Windowsã®ä¸–ç•Œ</p><h3 id=ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨>ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨<a href=#ã‚‚ã‚ã‚‚ã‚ã®é›‘ç”¨ class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Arch on WSL2</p><pre tabindex=0><code>kei@Win-Desktop-wsl
OS: Arch Linux on Windows 10 x86_64
Kernel: 5.4.72-microsoft-standard-WSL2
Shell: zsh 5.8
CPU: AMD Ryzen 7 3800X (16) @ 3.892GHz
Memory: 279MiB / 12733MiB
</code></pre><h3 id=archlinux-for-arm64ãŒã‚“ã°ã‚‹ã¨ã“ã‚>ArchLinux for ARM64ãŒã‚“ã°ã‚‹ã¨ã“ã‚<a href=#archlinux-for-arm64ãŒã‚“ã°ã‚‹ã¨ã“ã‚ class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Raspbian(32bit)</p><h3 id=kubernetesãŒã‚“ã°ã‚‹ã¨ã“ã‚>KubernetesãŒã‚“ã°ã‚‹ã¨ã“ã‚<a href=#kubernetesãŒã‚“ã°ã‚‹ã¨ã“ã‚ class=hanchor arialabel=Anchor>&#8983;</a></h3><p>ArchLinux ARM(64bit) on Raspberry Pi</p><h2 id=ä½œæ¥­æ‰‹é †>ä½œæ¥­æ‰‹é †<a href=#ä½œæ¥­æ‰‹é † class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=ä¸‹æº–å‚™ãƒ•ã‚§ã‚¤ã‚º>ä¸‹æº–å‚™ãƒ•ã‚§ã‚¤ã‚º<a href=#ä¸‹æº–å‚™ãƒ•ã‚§ã‚¤ã‚º class=hanchor arialabel=Anchor>&#8983;</a></h3><ol><li>çµ„ã¿ç«‹ã¦ã‚„ã£ã¦ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸Šã’ã‚‹</li><li>ãƒ¡ã‚¤ãƒ³ã®LANã«ã¶ã‚‰ã•ã’ã‚‹LANã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</li><li>Raspbian ã‚’ headlessã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<ol><li>ãƒ«ãƒ¼ã‚¿ã«æœ‰ç·šã§æ¥ç¶šã—ã¦ssh<ol><li>æ–°ãƒ¦ãƒ¼ã‚¶ä½œã£ã¦piãƒ¦ãƒ¼ã‚¶æ¶ˆã™</li><li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰â†’éµèªè¨¼ã¯ã‚„ã‚‰ãªã„(raspbianã‚’ã“ã®ã‚ã¨ä½¿ã‚ãªã„ã®ã§)</li></ol></li></ol></li><li>Raspbian ä¸Š ã§ ArchLinux ARM ã‚’ç„¼ã</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># $ã¯ã™ã¹ã¦ sudo</span>
</span></span><span style=display:flex><span>$ fdisk /dev/sda
</span></span><span style=display:flex><span><span style=color:#75715e># ã„ã„ã‹ã‚“ã˜ã«ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ‡ã‚‹</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mkfs.vfat /dev/sda1
</span></span><span style=display:flex><span>$ mkdir boot
</span></span><span style=display:flex><span>$ mount /dev/sda1 boot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ mkfs.ext4 /dev/sda2
</span></span><span style=display:flex><span>$ mkdir root
</span></span><span style=display:flex><span>$ mount /dev/sda2 root
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ã‚¤ãƒ¡ãƒ¼ã‚¸è½ã¨ã™</span>
</span></span><span style=display:flex><span>$ wget http://os.archlinuxarm.org/os/ArchLinuxARM-rpi-aarch64-latest.tar.gz
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ã“ã“ã‹ã‚‰å…ˆã¯suã™ã‚‹</span>
</span></span><span style=display:flex><span>$ su
</span></span><span style=display:flex><span>% bsdtar -xpf ArchLinuxARM-rpi-4-latest.tar.gz -C root
</span></span><span style=display:flex><span>% sync
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 64bit ã‹ã¤ rpi4 ãªã®ã§</span>
</span></span><span style=display:flex><span>% sed -i <span style=color:#e6db74>&#39;s/mmcblk0/mmcblk1/g&#39;</span> root/etc/fstab
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>% mv root/boot/* boot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ãƒã‚¦ãƒ³ãƒˆã—ãŸã‚‰ã¡ã‚ƒã‚“ã¨ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã—ã‚ˆã†ã­</span>
</span></span><span style=display:flex><span>% umount boot root
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ã“ã‚Œã‚’3ã‚»ãƒƒãƒˆ (ã•ã‚‰ã«åˆ¥ç”¨é€”ã§+1ã‚»ãƒƒãƒˆã‚„ã£ãŸã®ã¯ç§˜å¯†)</span>
</span></span></code></pre></div><h3 id=æœ¬ä½œæ¥­ãƒ•ã‚§ã‚¤ã‚º>æœ¬ä½œæ¥­ãƒ•ã‚§ã‚¤ã‚º<a href=#æœ¬ä½œæ¥­ãƒ•ã‚§ã‚¤ã‚º class=hanchor arialabel=Anchor>&#8983;</a></h3><h4 id=å„ãƒã‚·ãƒ³ã«ãƒ›ã‚¹ãƒˆåãµã£ãŸã‚Šãƒ¦ãƒ¼ã‚¶ä½œã£ãŸã‚Š>å„ãƒã‚·ãƒ³ã«ãƒ›ã‚¹ãƒˆåãµã£ãŸã‚Šãƒ¦ãƒ¼ã‚¶ä½œã£ãŸã‚Š<a href=#å„ãƒã‚·ãƒ³ã«ãƒ›ã‚¹ãƒˆåãµã£ãŸã‚Šãƒ¦ãƒ¼ã‚¶ä½œã£ãŸã‚Š class=hanchor arialabel=Anchor>&#8983;</a></h4><ul><li><code>pacman -Syyu</code> ã‚ã£ã¡ã‚ƒé‡ã„(å›½å†…ãƒŸãƒ©ãƒ¼ãªã•ãã†)</li><li><code>pacman -S sudo</code></li><li>ãƒ›ã‚¹ãƒˆåå¤‰ãˆãŸ<ul><li>kisaragi</li><li>mogami</li><li>kumano</li></ul></li><li>sudoersã„ã˜ã£ãŸ</li><li>å…¬é–‹éµèªè¨¼ä»¥å¤–å°ã˜ãŸ</li></ul><h4 id=kubernetesã¾ã‚ã‚Šã‚¬ãƒ¼ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«>Kubernetesã¾ã‚ã‚Šã‚¬ãƒ¼ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href=#kubernetesã¾ã‚ã‚Šã‚¬ãƒ¼ã£ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« class=hanchor arialabel=Anchor>&#8983;</a></h4><ul><li>Ansibleã§ã‚„ã‚ã†ã¨ã—ãŸãŒã€pacmanã ã‘ã§ãªãyayã‚‚ä½¿ã†ã®ã§ã¡ã‚‡ã£ã¨å³ã—ã‹ã£ãŸ<ul><li>ã®ã§æ¨ªç€ã—ã¦ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ›¸ã„ãŸãŒæ¨ªç€ã—ã™ãã¦ã‚³ã‚±ãŸ<ul><li>ã®ã§æœ€çµ‚çš„ã«åŠæ‰‹ä½œæ¥­â€¦â€¦</li></ul></li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash -eu
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>pacman -S git base base-devel --noconfirm
</span></span><span style=display:flex><span>mkdir ~/build/
</span></span><span style=display:flex><span>cd ~/build
</span></span><span style=display:flex><span>git clone https://aur.archlinux.org/yay.git
</span></span><span style=display:flex><span>cd ~/build/yay
</span></span><span style=display:flex><span>makepkg -si --noconfirm
</span></span><span style=display:flex><span>cd ~/
</span></span><span style=display:flex><span>yay -S docker kubelet-bin kubeadm-bin kubectl-bin ebtables ethtool socat conntrack-tools cni-plugins --noconfirm
</span></span></code></pre></div><h4 id=kubernetesã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—>Kubernetesã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—<a href=#kubernetesã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— class=hanchor arialabel=Anchor>&#8983;</a></h4><h5 id=å…¨ä½“æ§‹æˆ>å…¨ä½“æ§‹æˆ<a href=#å…¨ä½“æ§‹æˆ class=hanchor arialabel=Anchor>&#8983;</a></h5><ul><li>kisaragi : Master</li><li>mogami : node</li><li>kumano : node</li></ul><p>ãŠèˆ¹ã˜ã‚ƒãªã„ã‚ˆ</p><h5 id=kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‰åŠæˆ¦>kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‰åŠæˆ¦<a href=#kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å‰åŠæˆ¦ class=hanchor arialabel=Anchor>&#8983;</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo kubeadm init --pod-network-cidr<span style=color:#f92672>=</span>10.244.0.0/16
</span></span><span style=display:flex><span>mkdir -p $HOME/.kube
</span></span><span style=display:flex><span>sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
</span></span><span style=display:flex><span>sudo chown <span style=color:#66d9ef>$(</span>id -u<span style=color:#66d9ef>)</span>:<span style=color:#66d9ef>$(</span>id -g<span style=color:#66d9ef>)</span> $HOME/.kube/config
</span></span><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
</span></span></code></pre></div><h5 id=mogami--kumanoã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—>mogami & kumanoã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—<a href=#mogami--kumanoã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— class=hanchor arialabel=Anchor>&#8983;</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo systemctl enable kubelet.service
</span></span><span style=display:flex><span>sudo systemctl start kubelete.service
</span></span><span style=display:flex><span>sudo kubeadm join <span style=color:#f92672>{</span>ã„ã‚ã‚“ãªã²ã¿ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³<span style=color:#f92672>}</span>
</span></span></code></pre></div><h5 id=kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾ŒåŠæˆ¦>kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾ŒåŠæˆ¦<a href=#kisaragiã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾ŒåŠæˆ¦ class=hanchor arialabel=Anchor>&#8983;</a></h5><p>ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«ãƒãƒ¼ãƒ‰ã‚’å‚åŠ ã•ã›ã‚‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kubectl label node mogami node-role.kubernetes.io/worker<span style=color:#f92672>=</span>worker
</span></span><span style=display:flex><span>kubectl label node kumano node-role.kubernetes.io/worker<span style=color:#f92672>=</span>worker
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>kisaragi% kubectl version
</span></span><span style=display:flex><span>Client Version: version.Info<span style=color:#f92672>{</span>Major:<span style=color:#e6db74>&#34;1&#34;</span>, Minor:<span style=color:#e6db74>&#34;20&#34;</span>, GitVersion:<span style=color:#e6db74>&#34;v1.20.2&#34;</span>, GitCommit:<span style=color:#e6db74>&#34;faecb196815e248d3ecfb03c680a4507229c2a56&#34;</span>, GitTreeState:<span style=color:#e6db74>&#34;clean&#34;</span>, BuildDate:<span style=color:#e6db74>&#34;2021-01-13T13:28:09Z&#34;</span>, GoVersion:<span style=color:#e6db74>&#34;go1.15.5&#34;</span>, Compiler:<span style=color:#e6db74>&#34;gc&#34;</span>, Platform:<span style=color:#e6db74>&#34;linux/arm64&#34;</span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>Server Version: version.Info<span style=color:#f92672>{</span>Major:<span style=color:#e6db74>&#34;1&#34;</span>, Minor:<span style=color:#e6db74>&#34;20&#34;</span>, GitVersion:<span style=color:#e6db74>&#34;v1.20.2&#34;</span>, GitCommit:<span style=color:#e6db74>&#34;faecb196815e248d3ecfb03c680a4507229c2a56&#34;</span>, GitTreeState:<span style=color:#e6db74>&#34;clean&#34;</span>, BuildDate:<span style=color:#e6db74>&#34;2021-01-13T13:20:00Z&#34;</span>, GoVersion:<span style=color:#e6db74>&#34;go1.15.5&#34;</span>, Compiler:<span style=color:#e6db74>&#34;gc&#34;</span>, Platform:<span style=color:#e6db74>&#34;linux/arm64&#34;</span><span style=color:#f92672>}}}</span>
</span></span></code></pre></div><h4 id=ãªã‚“ã‹podå‹•ã‹ã—ã¦ã¿ã‚‹>ãªã‚“ã‹podå‹•ã‹ã—ã¦ã¿ã‚‹<a href=#ãªã‚“ã‹podå‹•ã‹ã—ã¦ã¿ã‚‹ class=hanchor arialabel=Anchor>&#8983;</a></h4><p>ã‚ªãƒ¬ã‚ªãƒ¬Docker Registryç½®ãã“ã¨ã«ã—ãŸ</p><p>deployment.yml</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>docker-registry</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>docker-registry</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>docker-registry</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>docker-registry</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>hostNetwork</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>tolerations</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>key</span>: <span style=color:#ae81ff>node-role.kubernetes.io/master</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>effect</span>: <span style=color:#ae81ff>NoSchedule</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>nodeSelector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>kubernetes.io/hostname</span>: <span style=color:#ae81ff>kisaragi</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>docker-registry</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>image</span>: <span style=color:#ae81ff>registry:2.7.1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>5000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>registry</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/var/lib/registry</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>registry</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>hostPath</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>Directory</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/mnt/exthdd/registry</span>
</span></span></code></pre></div><p>ã“ã‚Œã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã€å¤–ã‹ã‚‰pull & pushã—ã¦ã¿ã‚‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo docker pull hello-world
</span></span><span style=display:flex><span>sudo docker tag hello-world kisaragi.local:5000/hello-world
</span></span><span style=display:flex><span>sudo docker push kisaragi.local:5000/hello-world
</span></span></code></pre></div><p><strong>å‹•ã„ãŸï¼</strong></p><h2 id=ãã®ä»–ã‚‚ã‚ã‚‚ã‚>ãã®ä»–ã‚‚ã‚ã‚‚ã‚<a href=#ãã®ä»–ã‚‚ã‚ã‚‚ã‚ class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=ã¤ã‚‰ã‹ã£ãŸã“ã¨>ã¤ã‚‰ã‹ã£ãŸã“ã¨<a href=#ã¤ã‚‰ã‹ã£ãŸã“ã¨ class=hanchor arialabel=Anchor>&#8983;</a></h3><ul><li>ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§å†èµ·å‹•ã‹ã‘ãŸã‚‰ <code>kubectl</code> ã‚³ã‚±ãŸ<ul><li>masterã§ <code>systemctl enable kubelet</code> å¿˜ã‚Œã¦ãŸ</li></ul></li><li>ä¸€ç¬ä¸–ç•Œã‹ã‚‰å­¤ç«‹ã—ãŸã‚µãƒ¼ãƒã‚’ç”£ã¿è½ã¨ã—ã¦ã—ã¾ã£ãŸ<ul><li><code>~/.ssh/authorized_keys</code> ã‚’æ¶ˆã—ã¦ã—ã¾ã£ãŸ</li><li>åˆ¥ãƒã‚·ãƒ³ã§SDã‚«ãƒ¼ãƒ‰ã‚’ãƒã‚¦ãƒ³ãƒˆã—ã¦ <code>authorized_keys</code> ã‚’ä½œã‚‹ã“ã¨ã§ã”ã¾ã‹ã—ãŸ<ul><li><code>chmod {ãƒ¦ãƒ¼ã‚¶å}:sudo authorized_keys</code> å¿˜ã‚Œãšã«ã­</li></ul></li></ul></li></ul><h3 id=ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨ä»Šå¾Œã‚„ã‚ŠãŸã„ã“ã¨>ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨(ä»Šå¾Œã‚„ã‚ŠãŸã„ã“ã¨)<a href=#ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨ä»Šå¾Œã‚„ã‚ŠãŸã„ã“ã¨ class=hanchor arialabel=Anchor>&#8983;</a></h3><ul><li>PoE(USBã‚±ãƒ¼ãƒ–ãƒ«é‚ªé­”ã˜ã‚ƒã­ï¼Ÿ)</li><li>ãƒãƒ¼ãƒ‰å°æ•°ã®æ‹¡å¼µ</li><li>ç„¡ç·šLANãƒ«ãƒ¼ã‚¿ãŒã¡ã‚‡ã£ã¨æ®‹å¿µã ã£ãŸã®ã§æ”¹å–„<ul><li>ãƒ©ã‚ºãƒ‘ã‚¤ãƒ«ãƒ¼ã‚¿ã«ã—ã¡ã‚ƒã†</li></ul></li></ul><h2 id=çµè«–>çµè«–<a href=#çµè«– class=hanchor arialabel=Anchor>&#8983;</a></h2><ul><li>ArchLinuxã¯ã„ã„ã</li><li>k8sã¯ã„ã„ã</li><li>æ¨ªç€ã¯ã‚ˆããªã„ã</li></ul><h2 id=å‚è€ƒè¨˜äº‹>å‚è€ƒè¨˜äº‹<a href=#å‚è€ƒè¨˜äº‹ class=hanchor arialabel=Anchor>&#8983;</a></h2><ul><li><a href=https://archlinuxarm.org/platforms/armv8/broadcom/raspberry-pi-4>Raspberry Pi 4 | ArchLinux ARM</a></li><li><a href=https://qiita.com/tomotomo/items/2ff445377c13f9db38e2>Raspberry Pi 4 ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ãŒå¤‰ã‚ã£ãŸã</a></li><li><a href=https://developers.cyberagent.co.jp/blog/archives/14721/>3æ—¥é–“ã‚¯ãƒƒã‚­ãƒ³ã‚°ã€Kubernetes ã®ãƒ©ã‚ºãƒšãƒªãƒ¼ãƒ‘ã‚¤åŒ…ã¿ã€€â€œã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé¢¨ã€‘</a></li><li><a href=https://qiita.com/go_vargo/items/d1271ab60f2bba375dcc>Raspberry Piã§ãŠã†ã¡Kubernetesæ§‹ç¯‰ã€ç‰©ç†ç·¨ã€‘</a></li><li><a href=https://qiita.com/go_vargo/items/29f6d832ea0a289b4778>Raspberry Piã§ãŠã†ã¡Kubernetesæ§‹ç¯‰ã€è«–ç†ç·¨ã€‘</a></li><li><a href=https://qiita.com/temeteke/items/04960c96edee113bd053>Raspberry Pi 4ã¨Arch Linux(64bit)ã§ä½œã‚‹Kubernetesã‚¯ãƒ©ã‚¹ã‚¿)</a></li><li><a href=https://sminamot-dev.hatenablog.com/entry/2020/01/26/111949>Raspberry Pi 4 ã§ãŠã†ã¡k8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ§‹ç¯‰ã™ã‚‹</a></li><li><a href=https://qiita.com/yuyakato/items/c5b1b1293c5879e231ab>ãŠã†ã¡k8sã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹: Dockerãƒ¬ã‚¸ã‚¹ãƒˆãƒªç·¨</a></li></ul><hr><h2 id=è£œè¶³>è£œè¶³<a href=#è£œè¶³ class=hanchor arialabel=Anchor>&#8983;</a></h2><p>é‡è¦ãªã‚‚ã®ã ã‘è£œè¶³</p><blockquote><p>pacman -Syyu ã‚ã£ã¡ã‚ƒé‡ã„(å›½å†…ãƒŸãƒ©ãƒ¼ãªã•ãã†)</p></blockquote><p>ã¨ã„ã†è¨˜è¿°ãŒã‚ã‚Šã¾ã—ãŸãŒã€2021/11/18ã«Asahi LinuxãŒå›½å†…ãƒŸãƒ©ãƒ¼ã‚’ä½œæˆã—ã¦ãã‚Œã¾ã—ãŸï¼</p><blockquote class=twitter-tweet><p lang=en dir=ltr>We noticed that there was no Arch Linux ARM mirror in Japan, so we're sponsoring one now ğŸ˜Š<br><br>If you're in Japan or nearby, feel free to point your pacman.d/mirrorlist at <a href=https://t.co/GM69rZE3tC>https://t.co/GM69rZE3tC</a>!<a href=https://t.co/erKHtHwFfX>https://t.co/erKHtHwFfX</a> <a href=https://t.co/m0opnupc5i>pic.twitter.com/m0opnupc5i</a></p>&mdash; Asahi Linux (@AsahiLinux) <a href="https://twitter.com/AsahiLinux/status/1461268746878656513?ref_src=twsrc%5Etfw">November 18, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/furikaeri-2021/><span class=button__icon>â†</span>
<span class=button__text>2021å¹´ã®ãµã‚Šã‹ãˆã‚Š</span></a></span>
<span class="button next"><a href=/posts/use-systemd-timer-instead-of-crond/><span class=button__text>systemctl timer unitã‚’ä½¿ã£ã¦cronã‚’ç½®ãæ›ãˆãŸã¨ãã®ãƒ¡ãƒ¢</span>
<span class=button__icon>â†’</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>Â© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script></div></body></html>